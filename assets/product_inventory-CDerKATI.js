
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.hurui.me
 */
    
import{d as M,r as f,z as N,Q as B,a as d,o as H,k as I,b as C,e as t,w as a,g as _,t as L,E as T,x as z}from"./index-hvzRevkC.js";const J={class:"container"},O={class:"product-info"},A={class:"mb-4"},F={class:"dialog-footer"},P=M({__name:"product_inventory",setup(Q){const n=f({auditedCount:0,systemCount:0,difference:0,inbound_date:new Date}),s=f([]),y=f(0),m=f(!1),u=f(null);function c(){const l=window.innerHeight;y.value=l-200}N(()=>{c(),window.addEventListener("resize",c),b()}),B(()=>{window.removeEventListener("resize",c)});const g=[{product_number:1n,name:"产品1",auditedCount:10,systemCount:15,difference:5,last_inbound_date:"2023-01-01"},{product_number:2n,name:"产品2",auditedCount:20,systemCount:25,difference:5,last_inbound_date:"2023-02-01"},{product_number:3n,name:"产品3",auditedCount:30,systemCount:35,difference:5,last_inbound_date:"2023-03-01"},{product_number:4n,name:"产品4",auditedCount:40,systemCount:45,difference:5,last_inbound_date:"2023-04-01"},{product_number:5n,name:"产品5",auditedCount:50,systemCount:55,difference:5,last_inbound_date:"2023-05-01"},{product_number:6n,name:"产品6",auditedCount:60,systemCount:65,difference:5,last_inbound_date:"2023-06-01"},{product_number:7n,name:"产品7",auditedCount:70,systemCount:75,difference:5,last_inbound_date:"2023-07-01"},{product_number:8n,name:"产品8",auditedCount:80,systemCount:85,difference:5,last_inbound_date:"2023-08-01"},{product_number:9n,name:"产品9",auditedCount:90,systemCount:95,difference:5,last_inbound_date:"2023-09-01"},{product_number:10n,name:"产品10",auditedCount:100,systemCount:105,difference:5,last_inbound_date:"2023-10-01"}];function w(l){localStorage.setItem("products",JSON.stringify(l))}function V(){const l=localStorage.getItem("products");return l?JSON.parse(l):g}function b(){s.value=V()}function k(){if(u.value){n.value.difference=(n.value.systemCount||0)-(n.value.auditedCount||0);const l=s.value.findIndex(e=>{var i;return e.product_number===((i=u.value)==null?void 0:i.product_number)});l!==-1&&(s.value[l]={...u.value,...n.value},w(s.value),b(),m.value=!1,T.success("盘存结果录入成功"))}}function x(){u.value&&(n.value.auditedCount=u.value.auditedCount||0,n.value.systemCount=u.value.systemCount||0,n.value.difference=0,n.value.inbound_date=new Date,m.value=!0)}function S(){w(g),b()}return(l,e)=>{const i=d("el-button"),r=d("el-table-column"),D=d("el-table"),h=d("el-date-picker"),p=d("el-form-item"),v=d("el-input"),U=d("el-form"),E=d("el-dialog");return H(),I("div",J,[C("div",O,[C("div",A,[t(i,{type:"primary",plain:"",disabled:!u.value,onClick:x},{default:a(()=>e[7]||(e[7]=[_(" 盘点结果录入（先点击勾选产品） ")])),_:1},8,["disabled"]),t(i,{type:"warning",plain:"",onClick:S},{default:a(()=>e[8]||(e[8]=[_(" 还原数据 ")])),_:1})])]),t(D,{data:s.value,height:y.value,border:"",style:{width:"100%"},onRowClick:e[0]||(e[0]=o=>u.value=o)},{default:a(()=>[t(r,{type:"selection",width:"55"}),t(r,{label:"产品编号",width:"100",align:"center"},{default:a(o=>[_(L(o.row.product_number),1)]),_:1}),t(r,{property:"name",label:"产品名称",width:"120",align:"center"}),t(r,{property:"last_inbound_date",label:"最后入库日期",width:"180",align:"center"}),t(r,{property:"auditedCount",label:"更新前数量",width:"100",align:"center"}),t(r,{property:"systemCount",label:"更新后数量",width:"100",align:"center"}),t(r,{property:"difference",label:"数量变化差异",width:"120",align:"center"})]),_:1},8,["data","height"]),t(E,{modelValue:m.value,"onUpdate:modelValue":e[6]||(e[6]=o=>m.value=o),title:"盘存结果录入",width:"400px"},{footer:a(()=>[C("div",F,[t(i,{onClick:e[5]||(e[5]=o=>m.value=!1)},{default:a(()=>e[9]||(e[9]=[_(" 取消 ")])),_:1}),t(i,{type:"primary",onClick:k},{default:a(()=>e[10]||(e[10]=[_(" 确认 ")])),_:1})])]),default:a(()=>[t(U,{model:n.value,"label-width":"100px"},{default:a(()=>[t(p,{label:"最后入库日期"},{default:a(()=>[t(h,{modelValue:n.value.inbound_date,"onUpdate:modelValue":e[1]||(e[1]=o=>n.value.inbound_date=o),type:"date",placeholder:"选择日期",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(p,{label:"更新前数量"},{default:a(()=>[t(v,{modelValue:n.value.auditedCount,"onUpdate:modelValue":e[2]||(e[2]=o=>n.value.auditedCount=o),modelModifiers:{number:!0},type:"number",min:"1"},null,8,["modelValue"])]),_:1}),t(p,{label:"更新后数量"},{default:a(()=>[t(v,{modelValue:n.value.systemCount,"onUpdate:modelValue":e[3]||(e[3]=o=>n.value.systemCount=o),modelModifiers:{number:!0},type:"number",min:"1"},null,8,["modelValue"])]),_:1}),t(p,{label:"数量变化差异"},{default:a(()=>[t(v,{modelValue:n.value.difference,"onUpdate:modelValue":e[4]||(e[4]=o=>n.value.difference=o),modelModifiers:{number:!0},type:"number",min:"1"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),$=z(P,[["__scopeId","data-v-e4757961"]]);export{$ as default};
